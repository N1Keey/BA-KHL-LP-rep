{% extends "_base.j2" %}
{% block styles %}
    {{ super() }}
    <style>
        #btn_addkh, #tf_addkh{
            display:inline;
            padding:0;
            height:30px;
        }
        #tf_addkh{width:80%}
        #btn_addkh{
            width:20%;
            margin-left: -4;
        }
        .kh_active{
            background-color:lightgreen
        }
        table {
            width: 100%;
            margin:0;
        }
        #btn_schema{
            width:100%;
            height:100%;
        }
        .schema_active{
            background-color:lightgreen
        }
        #btn_add {
            margin-left:-4;
        }
        .schemacontent ul{
            height:72%;
            overflow:hidden; 
            overflow-y:scroll;
        }
        .schemacontent li{
            border-bottom: 1px solid #ddd;
            height:30;
        }
        #btn_del{
            float:right;
        }
        #btn_contentchange{
            float:right;
        }
        .schemacontent input[type=text]{
            width: initial;
        }
        #krankheit_√§ndern h3, button{
            display: inline;
        }
        .kh_umst√§nde{
            height:72%;
            overflow:hidden; 
            overflow-y:scroll;
        }
        #searchfield{
            width:90%;
        }
        #searchsubmit{
            width:10%;
        }
        .btns_umstand{
            margin-top:-14;
        }
    </style>
{% endblock %}
{% set active_link = 'Stoff' %}
{% block title %} <title>Stoff</title> {% endblock %}
{% block navbar %}
    {{ super() }}
{% endblock %}
{% block vert_navbar %}
    <div class='vert_navbar'>
        <form action='/hinzuf√ºgen_Krankheit' method='POST'>
            <input type="text" id="tf_addkh" name="Krankheit_name" placeholder="Neue Krankheit:" autocomplete="off">
            <button type="submit" name= "Btn_add_Krankheit" id="btn_addkh">einf√ºgen</button>
        </form>
        {% if mode=='uok_Addkhmode' and (active_schema=='Ursachen' or active_schema =='Komplikationen') %}
            <form action="hinzuf√ºgen_{{active_schema}}" method='POST'>
                <ul class="cbx_kh">
                    {% for krankheit in krankheiten %}
                        <li>
                            <label class='kh_checkbox_label'>
                                {{ krankheit }}<input type="checkbox" name="checkbox_Krankheit" value="{{ krankheit }}" id="cbx_kh">
                            </label>
                        </li>
                    {% endfor %}
                </ul>
                <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
                <input type="submit" name="uok_Addkh" value="Krankheit hinzuf√ºgen" id="btn_kh_cbxsubmit">
            </form>
        {% else %}
            <form method='POST'>
                <ul class="btn_kh">
                    {% for krankheit in krankheiten %}
                        <li>
                            <button {% if active_krankheit == krankheit %} class="kh_active" {% endif %} type="submit" name="active_krankheit" value="{{ krankheit }}" id="btn_kh">{{ krankheit }}</button>
                        </li>
                    {% endfor %}
                </ul>
            </form>
        {% endif %}
    </div>
{% endblock %}
{% block content %}
    <div class='content'>
        <form action='/suche' method='POST'>
            <span>
                <input type='text' name='searchfield' placeholder='Suchfeld:' id='searchfield'><input type='submit' name='searchsubmit' value='Suche' id='searchsubmit'>
            </span>
        </form>
        <form method='POST'>
            <table class='btns_umstand'>
                <tr>
                    <th><button {% if active_schema == 'Ursachen' %} class="schema_active" {% endif %} type="submit" name="active_schema" value="Ursachen" id="btn_schema">Ursachen</button></th>
                    <th><button {% if active_schema == 'Symptome' %} class="schema_active" {% endif %} type="submit" name="active_schema" value="Symptome" id="btn_schema">Symptome</button></th>
                    <th><button {% if active_schema == 'Komplikationen' %} class="schema_active" {% endif %} type="submit" name="active_schema" value="Komplikationen" id="btn_schema">Komplikationen</button></th>
                    <th><button {% if active_schema == 'Diagnostiken' %} class="schema_active" {% endif %} type="submit" name="active_schema" value="Diagnostiken" id="btn_schema">Diagnostiken</button></th>
                    <th><button {% if active_schema == 'Therapien' %} class="schema_active" {% endif %} type="submit" name="active_schema" value="Therapien" id="btn_schema">Therapien</button></th>
                </tr>
            </table>
            <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
        </form>
        {% if active_krankheit %}
            {% if not active_schema %} 
                {% if element2change %}
                    <form action='/√§ndern_Krankheit' method='POST'>
                        <input type='text' name='elemupdate' value='{{ element2change }}' autocomplete="off">
                        <input type='submit' name='abbruch' value=Abbruch>
                        <input type='submit' name='khchange' value='√Ñndern'>
                        <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
                    </form>
                {% elif element2delete %}
                    <form action='/l√∂schen_Krankheit' method='POST'>
                        Sicher?
                        <input type='submit' name='abbruch' value=Abbruch>
                        <input type='submit' name='khdelete' value='Ja'>
                        <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
                    </form>
                {% else %}
                    <span id='krankheit_√§ndern'>
                        <form method='POST'>
                            <h3>{{active_krankheit}}</h3>
                            <button type = 'submit' name='√§ndern' value='{{ active_krankheit }}'>üñäÔ∏è</button>
                            <button type = 'submit' name='l√∂schen' value='{{ active_krankheit }}'>üóëÔ∏è</button>
                            <input type="hidden" name="active_krankheit" value="{{ active_krankheit }}">
                        </form>
                    </span>
                    {% for krankheit in krankheitendict %}
                        {% if krankheit.get('Krankheit') == active_krankheit %}
                            <ul class='kh_umst√§nde'>
                                {% for umstand in krankheit %}
                                    {% if umstand != 'Krankheit' %}
                                        <li><h5><b>{{umstand}}</b></h5></li>
                                            <ul>
                                                {% for element in krankheit.get(umstand) %}
                                                    <li>{{ element }}</li>
                                                {% endfor %}
                                            </ul>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% else %}
                <form action="hinzuf√ºgen_{{active_schema}}" method='POST'>
                    <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
                    <input type="hidden" name="active_schema" value="{{active_schema}}">
                    {% if not mode %}
                        <input type="text" name="kh_new{{active_schema}}" placeholder="Neue {{ active_schema }}" autocomplete="off" autofocus id="tf_add">
                        <input type="submit" name="kh_add{{active_schema}}" id="btn_add" value="hinzuf√ºgen">
                    {% else %}
                        <h4> {{active_krankheit}} </h4> 
                    {% endif %}
                    {% if active_schema == 'Ursachen' or active_schema == 'Komplikationen' %}
                        <button type="submit" name="mode" value="uok_Addkhmode" id="btn_uok_joinkh">
                            {% if mode == 'uok_Addkhmode' %}Abbruch{% else %}Krankheit zu {{active_schema}} hinzuf√ºgen{% endif %}
                        </button>
                    {% endif %}
                </form>
            {% endif %}
        {% else %}
            <p><--Erst Krankheit ausw√§hlen</p>
        {% endif %}
        {% if active_schema %}
            <div class = 'schemacontent'>
                <ul>
                    {% for element in schemacontent %}
                        <li>
                            {% if element2change==element %}
                                <form action='/√§ndern_{{ active_schema }}' method='POST'>
                                    <input type='text' name='elemupdate' value='{{ element }}' autocomplete="off">
                                    <input type='submit' name='abbruch' value=Abbruch>
                                    <input type='submit' name='ch_alle' value='Alle'>
                                    <input type='submit' name='ch_nurdieses' value='Nur dieses Element'>
                                    <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
                                    <input type="hidden" name="active_schema" value="{{active_schema}}">
                                    <input type="hidden" name="content" value="{{ element2change }}">
                                </form>
                            {% elif element2delete==element %}
                                <form action='/l√∂schen_{{ active_schema }}' method='POST'>
                                    {{ element }}
                                    <input type='submit' name='abbruch' value=Abbruch>
                                    <input type='submit' name='del_alle' value='Alle'>
                                    <input type='submit' name='del_nurdieses' value='Nur dieses Element'>
                                    <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
                                    <input type="hidden" name="active_schema" value="{{active_schema}}">
                                    <input type="hidden" name="content" value="{{ element2delete }}">
                                </form>
                            {% else %}
                                <span>
                                    <form method='POST'>
                                        {{ element }}
                                        <button type='submit' name='l√∂schen' value='{{ element }}' id='btn_del'>üóëÔ∏è</button>
                                        <button type = 'submit' name='√§ndern' value='{{ element }}' id='btn_contentchange'>üñäÔ∏è</button>
                                        <input type="hidden" name="active_krankheit" value="{{active_krankheit}}">
                                        <input type="hidden" name="active_schema" value="{{active_schema}}">
                                    </form>
                                </span>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
    </div>      
{% endblock %}